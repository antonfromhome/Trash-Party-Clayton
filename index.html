<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrashParty - Less Litter, More Community</title>
<link rel="icon" type="image/png" href="/trash-party-logo.png">
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ESJJP6CSH6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-ESJJP6CSH6');
    </script>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Bebas+Neue&family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background-color: #fafafa; color: #1a1a1a; line-height: 1.6; }

        
        .container { max-width: 1200px; margin: 0 auto; padding: 40px 20px; }

.universal-stats {
    background: white;
    border-radius: 20px;
    padding: 50px 40px;
    margin: -60px auto 60px;
    max-width: 1200px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.08);
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 40px;
    text-align: center;
}        .stat-item h2 { font-size: 4em; font-weight: 800; color: #2d5016; margin-bottom: 8px; line-height: 1; }
        .stat-item p { font-size: 0.95em; color: #666; font-weight: 500; text-transform: uppercase; letter-spacing: 0.5px; }

        .map-section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 60px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
        }
        .section-header { text-align: center; margin-bottom: 40px; }
        .section-header h2 { font-size: 2.5em; font-weight: 700; color: #1a1a1a; margin-bottom: 12px; }
        .section-header p { font-size: 1.1em; color: #666; }

        #map { height: 500px; width: 100%; border-radius: 16px; overflow: hidden; margin-bottom: 30px; }

        .neighborhoods-section h2 { font-size: 2em; font-weight: 700; color: #1a1a1a; margin-bottom: 8px; }
        .neighborhoods-section p.subtitle { color: #666; font-size: 1.05em; margin-bottom: 30px; }

        .neighborhoods-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 24px;
            margin-bottom: 60px;
        }

        .neighborhood-card {
            background: white;
            border-radius: 16px;
            padding: 28px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
            transition: all 0.3s ease;
            text-decoration: none;
            color: inherit;
            display: block;
            border: 2px solid transparent;
        }
        .neighborhood-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
            border-color: #4CAF50;
        }
        .neighborhood-card h3 { font-size: 1.5em; font-weight: 700; color: #2d5016; margin-bottom: 4px; }
        .neighborhood-card .location { font-size: 0.88em; color: #999; margin-bottom: 16px; }

        .neighborhood-stats { display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 16px; }
        .neighborhood-stats span { font-size: 0.88em; color: #666; font-weight: 500; }
        .neighborhood-stats strong { color: #2d5016; }

        .visit-link { display: inline-flex; align-items: center; gap: 6px; color: #2d5016; font-weight: 600; font-size: 0.9em; }
        .visit-link::after { content: "→"; transition: transform 0.2s ease; }
        .neighborhood-card:hover .visit-link::after { transform: translateX(4px); }

        .cta-section {
            background: linear-gradient(135deg, #f0f8f0 0%, #e8f5e8 100%);
            border-radius: 20px;
            padding: 60px 40px;
            margin-bottom: 60px;
            text-align: center;
        }
        .cta-section h2 { font-size: 2.5em; font-weight: 700; color: #2d5016; margin-bottom: 20px; }
        .cta-section p { font-size: 1.2em; color: #555; margin-bottom: 30px; max-width: 600px; margin-left: auto; margin-right: auto; }

        .button {
            background: #2d5016;
            color: white;
            padding: 18px 48px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            font-family: 'Inter', sans-serif;
            transition: all 0.2s ease;
            display: inline-block;
            text-decoration: none;
            cursor: pointer;
        }
        .button:hover { background: #3d6b1f; transform: translateY(-2px); }

        footer {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
            text-align: center;
        }
        footer img { height: 80px; margin-bottom: 20px; }
        footer p { color: #666; font-size: 0.95em; margin-bottom: 10px; }
        footer a { color: #2d5016; font-weight: 600; text-decoration: none; }
        footer a:hover { text-decoration: underline; }

        .loading { text-align: center; padding: 20px; color: #2d5016; }

        @media (max-width: 768px) {
            .hero h1 { font-size: 2.5em; }
            .hero p { font-size: 1.1em; }
            .universal-stats { margin: -40px 20px 40px; padding: 30px 20px; gap: 30px; }
            .stat-item h2 { font-size: 3em; }
            #map { height: 400px; }
            .cta-section { padding: 40px 20px; }
            .cta-section h2 { font-size: 1.8em; }
        }
   /* Trash Party Header Banner */
.banner {
    width: 100%;
    max-width: 960px;
    height: 120px;
    background: #1a2e0a;
    border-radius: 10px;
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    padding: 0 36px;
    box-shadow: 0 8px 40px rgba(0,0,0,0.3);
    gap: 0;
    margin: 40px auto;
}

.banner::before {
    content: '';
    position: absolute;
    inset: 0;
    background-image: 
        radial-gradient(circle at 10% 120%, rgba(76, 175, 80, 0.14) 0%, transparent 55%),
        radial-gradient(circle at 90% -20%, rgba(139, 195, 74, 0.10) 0%, transparent 50%),
        url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%234CAF50' fill-opacity='0.04'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    pointer-events: none;
}

.banner::after {
    content: '';
    position: absolute;
    top: 0; right: 0;
    width: 200px; height: 200px;
    background: radial-gradient(circle at top right, rgba(124, 205, 60, 0.13), transparent 70%);
    pointer-events: none;
}

.bottom-stripe {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, #7ccd3c 0%, #4CAF50 40%, transparent 100%);
}

.left {
    display: flex;
    align-items: center;
    gap: 20px;
    position: relative;
    z-index: 2;
    flex-shrink: 0;
}

.icon-wrap {
    opacity: 0.75;
    flex-shrink: 0;
}

.wordmark {
    display: flex;
    flex-direction: column;
    gap: 1px;
}

.wordmark .label {
    font-family: 'Space Mono', monospace;
    font-size: 9px;
    letter-spacing: 4px;
    color: #7ccd3c;
    text-transform: uppercase;
    font-style: italic;
}

.wordmark .title {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 52px;
    line-height: 0.88;
    letter-spacing: 1px;
}

.wordmark .title .trash { color: #ffffff; }
.wordmark .title .party { color: #7ccd3c; }

.wordmark .domain {
    font-family: 'Space Mono', monospace;
    font-size: 9px;
    color: rgba(255,255,255,0.38);
    letter-spacing: 2px;
    margin-top: 2px;
}

.vert-divider {
    width: 1px;
    height: 56px;
    background: rgba(124, 205, 60, 0.25);
    margin: 0 32px;
    flex-shrink: 0;
    position: relative;
    z-index: 2;
}

.center {
    flex: 1;
    position: relative;
    z-index: 2;
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.tagline {
    font-family: 'Space Mono', monospace;
    font-size: 12px;
    color: rgba(255,255,255,0.75);
    letter-spacing: 0.5px;
    line-height: 1.6;
    font-style: italic;
}

.tagline em {
    color: #7ccd3c;
    font-style: normal;
    font-weight: 700;
}

.sub-label {
    font-family: 'Space Mono', monospace;
    font-size: 9px;
    letter-spacing: 3px;
    color: rgba(255,255,255,0.3);
    text-transform: uppercase;
}

.dots {
    position: absolute;
    bottom: 14px;
    right: 36px;
    display: flex;
    gap: 5px;
    align-items: center;
    z-index: 2;
}

.dot {
    width: 5px; height: 5px;
    border-radius: 50%;
    background: #7ccd3c;
    opacity: 0.5;
}

.dot:nth-child(2) { opacity: 0.3; width: 4px; height: 4px; }
.dot:nth-child(3) { opacity: 0.15; width: 3px; height: 3px; }

.banner:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 50px rgba(0,0,0,0.35);
    transition: all 0.2s ease;
}

@media (max-width: 768px) {
    .banner {
        height: auto;
        padding: 24px 20px;
        flex-direction: column;
        align-items: flex-start;
        gap: 20px;
    }
    
    .vert-divider { display: none; }
    
    .wordmark .title { font-size: 40px; }
    
    .center { align-items: flex-start; }
    
    .dots { display: none; }
}
   </style>
</head>
<body>
    <div class="banner">
    <!-- Left: icon + wordmark -->
    <div class="left">
        <div class="icon-wrap">
            <svg width="36" height="44" viewBox="0 0 48 56" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M18 8 Q24 2 30 8" stroke="#7ccd3c" stroke-width="2.5" stroke-linecap="round" fill="none"/>
                <path d="M12 10 Q8 10 7 18 L5 44 Q5 52 24 52 Q43 52 43 44 L41 18 Q40 10 36 10 Z" fill="#7ccd3c" opacity="0.18"/>
                <path d="M12 10 Q8 10 7 18 L5 44 Q5 52 24 52 Q43 52 43 44 L41 18 Q40 10 36 10 Z" stroke="#7ccd3c" stroke-width="2" fill="none" opacity="0.7"/>
                <path d="M16 16 Q14 28 15 40" stroke="white" stroke-width="1.5" stroke-linecap="round" opacity="0.2"/>
            </svg>
        </div>
        <div class="wordmark">
            <span class="label">// Neighborhood cleanups</span>
            <div class="title">
                <span class="trash">Trash</span><span class="party">Party</span>
            </div>
            <div class="domain">trashparty.org</div>
        </div>
    </div>

    <div class="vert-divider"></div>

    <!-- Center: tagline -->
    <div class="center">
        <div class="tagline">Less litter, <em>more community</em></div>
        <div class="sub-label">No accounts · No meetings · Just neighbors taking care of their streets</div>
    </div>

    <div class="bottom-stripe"></div>

    <div class="dots">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
    </div>
</div>

    <div class="container">
        <!-- Universal Stats -->
<div class="universal-stats">
    <div class="stat-item">
        <h2 id="totalNeighborhoods">0</h2>
        <p>Active Neighborhoods</p>
    </div>
    <div class="stat-item">
        <h2 id="totalNeighbors">0</h2>
        <p>Neighbors Helping</p>
    </div>
    <div class="stat-item">
        <h2 id="totalBags">0</h2>
        <p>Bags Collected</p>
    </div>
    <div class="stat-item">
        <h2 id="totalPounds">0</h2>
        <p>Pounds of Litter Picked Up</p>
    </div>
</div>

        <!-- Map -->
        <div class="map-section">
            <div class="section-header">
                <h2>Active Denver Neighborhoods</h2>
                <p>Click a neighborhood to see their cleanup map</p>
                <div id="loadingMessage" class="loading">Loading neighborhoods...</div>
            </div>
            <div id="map"></div>
        </div>

        <!-- Neighborhood Cards -->
        <div class="neighborhoods-section">
            <h2>Active Neighborhoods</h2>
            <p class="subtitle">Select your neighborhood to log a cleanup or see local progress</p>
            <div id="neighborhoodCards" class="neighborhoods-grid"></div>
        </div>
<!-- Email Signup Section -->
<div style="background: white; border-radius: 20px; padding: 50px 40px; margin-bottom: 60px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06); max-width: 600px; margin-left: auto; margin-right: auto;">
    <h2 style="font-size: 2em; font-weight: 700; color: #1a1a1a; margin-bottom: 10px; text-align: center;">Connect</h2>
    <p style="color: #666; margin-bottom: 30px; font-size: 1.05em; text-align: center;">A trashy mailing list for infrequent Trash Party updates</p>
    
    <form id="landingEmailForm">
        <!-- Honeypot field -->
        <div style="position: absolute; left: -5000px;" aria-hidden="true">
            <input type="text" name="honeypot" id="emailHoneypot" tabindex="-1" autocomplete="off">
        </div>
        
        <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 0.95em;">Email Address</label>
            <input type="email" id="landingEmailInput" required placeholder="your.email@example.com" style="width: 100%; padding: 14px 16px; border: 2px solid #e8e8e8; border-radius: 12px; font-size: 1em; font-family: 'Inter', sans-serif; background: #fafafa;">
        </div>
        
        <button type="submit" id="landingEmailSubmitBtn" style="background: #2d5016; color: white; padding: 16px 40px; border: none; border-radius: 8px; cursor: pointer; font-size: 1.05em; font-weight: 600; font-family: 'Inter', sans-serif; width: 100%;">Sign Up</button>
        
        <div id="landingEmailMessage" style="margin-top: 20px;"></div>
    </form>
</div><!-- What is Trash Party Section -->
<div style="background: white; border-radius: 20px; padding: 50px 40px; margin-bottom: 40px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);">
    <h2 style="font-size: 2em; font-weight: 700; color: #1a1a1a; margin-bottom: 20px;">What is Trash Party?</h2>
    
    <p style="color: #555; font-size: 1.1em; line-height: 1.8; margin-bottom: 15px;">Tired of seeing litter on your street? Same.</p>
    
    <p style="color: #555; font-size: 1.1em; line-height: 1.8; margin-bottom: 15px;">Trash Party is a simple, grassroots way to take pride in where you live — no waiting, no red tape, just neighbors showing up.</p>
    
    <p style="color: #555; font-size: 1.1em; line-height: 1.8; margin-bottom: 15px;">Step outside, invite a friend, and turn a quick cleanup into something social. Whether you have 15 minutes or an hour, you'll get some fresh air, move your body, meet people, and leave your block better than you found it. Log your cleanup on the map to build momentum.</p>
    
    <p style="color: #2d5016; font-size: 1.1em; line-height: 1.8; font-weight: 500; font-style: italic;">No formal membership, no meetings, no hassle. We just share the belief that all trash belongs in a can.</p>
</div>
        <!-- CTA -->
<!-- Start a Trash Party Section -->
<div style="background: linear-gradient(135deg, #f0f8f0 0%, #e8f5e8 100%); border-radius: 20px; padding: 60px 40px; margin-bottom: 60px; text-align: center;">
    <h2 style="font-size: 2.2em; font-weight: 700; color: #2d5016; margin-bottom: 15px;">Want to bring Trash Party to your neighborhood?</h2>
    <p style="font-size: 1.1em; color: #555; margin-bottom: 30px;">Fill out the form below and we'll help you get started!</p>
    
    <!-- Contact Form -->
    <div style="max-width: 600px; margin: 0 auto; background: white; padding: 40px; border-radius: 16px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);">
        <form id="neighborhoodRequestForm">
            <!-- Honeypot field - hidden from humans, visible to bots -->
            <div style="position: absolute; left: -5000px;" aria-hidden="true">
                <input type="text" name="honeypot" id="requestHoneypot" tabindex="-1" autocomplete="off">
            </div>
            
            <div style="margin-bottom: 20px; text-align: left;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 0.95em;">Name</label>
                <input type="text" id="requestName" required placeholder="Your name" style="width: 100%; padding: 14px 16px; border: 2px solid #e8e8e8; border-radius: 12px; font-size: 1em; font-family: 'Inter', sans-serif; background: #fafafa;">
            </div>
            
            <div style="margin-bottom: 20px; text-align: left;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 0.95em;">Email</label>
                <input type="email" id="requestEmail" required placeholder="your.email@example.com" style="width: 100%; padding: 14px 16px; border: 2px solid #e8e8e8; border-radius: 12px; font-size: 1em; font-family: 'Inter', sans-serif; background: #fafafa;">
            </div>
            
            <div style="margin-bottom: 20px; text-align: left;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 0.95em;">Neighborhood</label>
                <input type="text" id="requestNeighborhood" required placeholder="e.g., Five Points" style="width: 100%; padding: 14px 16px; border: 2px solid #e8e8e8; border-radius: 12px; font-size: 1em; font-family: 'Inter', sans-serif; background: #fafafa;">
            </div>
            
            <div style="margin-bottom: 20px; text-align: left;">
                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333; font-size: 0.95em;">Zip Code</label>
                <input type="text" id="requestZip" required placeholder="80205" style="width: 100%; padding: 14px 16px; border: 2px solid #e8e8e8; border-radius: 12px; font-size: 1em; font-family: 'Inter', sans-serif; background: #fafafa;">
            </div>
            
            <button type="submit" id="requestSubmitBtn" style="background: #2d5016; color: white; padding: 16px 40px; border: none; border-radius: 8px; cursor: pointer; font-size: 1.05em; font-weight: 600; font-family: 'Inter', sans-serif; width: 100%;">Submit Request</button>
            
            <div id="requestFormMessage" style="margin-top: 20px;"></div>
        </form>
    </div>
</div>
       
    </div>

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Firebase and Main App Script -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
import { getFirestore, collection, getDocs, query, addDoc } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBJEBbDfgShAp-vzCVm2ysivy1MX5MFZhQ",
            authDomain: "clayton-cleanup.firebaseapp.com",
            projectId: "clayton-cleanup",
            storageBucket: "clayton-cleanup.firebasestorage.app",
            messagingSenderId: "753353969491",
            appId: "1:753353969491:web:d8f2a5e55cc91915e5dba6"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const L = window.L;

        // Neighborhood configurations with EXACT GPS coordinates
        const neighborhoods = [
            {
                name: "Clayton",
                city: "Denver, CO",
                slug: "clayton",
                collection: "cleanups",
                center: [39.767245, -104.950215],
                bounds: [[39.761753, -104.959830], [39.772737, -104.940599]]
            },
            {
                name: "Cole",
                city: "Denver, CO",
                slug: "cole",
                collection: "cleanups-cole",
                center: [39.767465, -104.966484],
                bounds: [[39.762022, -104.973372], [39.772907, -104.959596]]
            },
            {
                name: "Skyland",
                city: "Denver, CO",
                slug: "skyland",
                collection: "cleanups-skyland",
                center: [39.756429, -104.950185],
                bounds: [[39.750845, -104.959766], [39.762013, -104.940604]]
            },
            {
                name: "Whittier",
                city: "Denver, CO",
                slug: "whittier",
                collection: "cleanups-whittier",
                center: [39.756397, -104.966593],
                bounds: [[39.750739, -104.973384], [39.762055, -104.959801]]
            }
        ];

        // Initialize map - centered to show all 4 neighborhoods
        const map = L.map('map').setView([39.761841, -104.961837], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap contributors',
            maxZoom: 19
        }).addTo(map);

        // Load stats and render everything
        async function loadAllStats() {
    let totalBags = 0;
    let totalPounds = 0;
    let activeNeighborhoods = 0;
    const allNeighbors = new Set(); // Track unique neighbors across all neighborhoods

    // Fetch real data for each neighborhood
    await Promise.all(neighborhoods.map(async (n) => {
                try {
                    const snap = await getDocs(query(collection(db, n.collection)));
                    let bags = 0;
                    const nbrs = new Set();
                    
                    snap.forEach(doc => {
    const d = doc.data();
    bags += d.bags || 0;
    if (d.volunteer) {
        const volunteerName = d.volunteer.trim().toLowerCase();
        nbrs.add(volunteerName);
        allNeighbors.add(volunteerName); // Add to global set
    }
});
                    n.bags = bags;
                    n.neighbors = nbrs.size;
                    n.pounds = bags * 5;
                    
                    if (bags > 0) activeNeighborhoods++;
                    
                    totalBags += bags;
                    totalPounds += bags * 5;
                } catch(e) {
                    console.log(`No data yet for ${n.name}`);
                    n.bags = 0;
                    n.neighbors = 0;
                    n.pounds = 0;
                }
            }));

// Update stats
document.getElementById('totalNeighborhoods').textContent = activeNeighborhoods;
document.getElementById('totalNeighbors').textContent = allNeighbors.size;
document.getElementById('totalBags').textContent = totalBags;
document.getElementById('totalPounds').textContent = '~' + totalPounds;
            // Render map and cards
            renderMap();
            renderCards();

            document.getElementById('loadingMessage').style.display = 'none';
        }

        function renderMap() {
            neighborhoods.forEach(n => {
                const hasData = (n.bags || 0) > 0;
                
                // Draw boundary
                const rect = L.rectangle(n.bounds, {
                    color: hasData ? '#2d5016' : '#999',
                    weight: hasData ? 3 : 2,
                    fillColor: hasData ? '#4CAF50' : '#cccccc',
                    fillOpacity: hasData ? 0.3 : 0.15
                }).addTo(map);

                rect.on('click', () => {
                    window.location.href = `/${n.slug}`;
                });

                rect.bindPopup(`
                    <div style="text-align:center; padding:8px;">
                        <strong style="font-size:1.1em;">${n.name}</strong><br>
                        <span style="color:#666; font-size:0.9em;">
                            ${hasData ? `${n.bags} bags • ${n.neighbors} neighbors` : 'No cleanups yet'}
                        </span><br>
                        <a href="/${n.slug}" style="color:#2d5016; font-weight:600; font-size:0.95em; margin-top:4px; display:inline-block;">Visit →</a>
                    </div>
                `);

                // Label
                const label = L.marker(n.center, {
                    icon: L.divIcon({
                        className: 'neighborhood-label',
                        html: `<div style="background:${hasData ? '#2d5016' : '#888'}; color:white; padding:6px 12px; border-radius:8px; font-weight:600; font-size:13px; white-space:nowrap; box-shadow:0 2px 8px rgba(0,0,0,0.3); cursor:pointer;">${n.name}</div>`,
                        iconSize: [100, 30]
                    })
                }).addTo(map);
                
                label.on('click', () => {
                    window.location.href = `/${n.slug}`;
                });
            });
        }

        function renderCards() {
            const container = document.getElementById('neighborhoodCards');
            
            neighborhoods.forEach(n => {
                const hasData = (n.bags || 0) > 0;
                const card = document.createElement('a');
                card.href = `/${n.slug}`;
                card.className = 'neighborhood-card';
                card.innerHTML = `
                    <h3>${n.name}</h3>
                    <div class="location">${n.city}</div>
                    <div class="neighborhood-stats">
                        <span><strong>${n.bags || 0}</strong> bags</span>
                        <span><strong>${n.neighbors || 0}</strong> neighbors</span>
                        <span><strong>${n.pounds || 0}</strong> lbs</span>
                    </div>
                    <div class="visit-link">${hasData ? 'View cleanups' : 'Be the first to log'}</div>
                `;
                container.appendChild(card);
            });
        }

        // Load everything on page load
        loadAllStats();
       
// Handle neighborhood request form
document.getElementById('neighborhoodRequestForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const submitBtn = document.getElementById('requestSubmitBtn');
    const messageEl = document.getElementById('requestFormMessage');
    submitBtn.disabled = true;
    submitBtn.textContent = 'Sending...';
    
    // Check honeypot
    if (document.getElementById('requestHoneypot').value !== '') {
        // Bot detected - silently reject
        messageEl.innerHTML = '<p style="background: #e8f5e9; color: #2d5016; padding: 12px 20px; border-radius: 8px; font-weight: 500;">Thanks! We\'ll be in touch soon.</p>';
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit Request';
        this.reset();
        return; // Don't save to database
    }

    const requestData = {
        name: document.getElementById('requestName').value,
        email: document.getElementById('requestEmail').value,
        neighborhood: document.getElementById('requestNeighborhood').value,
        zip: document.getElementById('requestZip').value,
        timestamp: new Date().toISOString()
    };
    
    try {
        await addDoc(collection(db, "neighborhoodRequests"), requestData);
        
        messageEl.innerHTML = '<p style="background: #e8f5e9; color: #2d5016; padding: 12px 20px; border-radius: 8px; font-weight: 500;">Thanks! We\'ll be in touch soon to help you get started.</p>';
        this.reset();
        
        setTimeout(() => {
            messageEl.innerHTML = '';
        }, 5000);
        
    } catch (error) {
        console.error("Error saving request:", error);
        messageEl.innerHTML = '<p style="background: #ffebee; color: #c62828; padding: 12px 20px; border-radius: 8px; font-weight: 500;">Error submitting. Please email hello-trash@trashparty.org</p>';
    } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit Request';
    }
});
// Handle landing page email signup
document.getElementById('landingEmailForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const submitBtn = document.getElementById('landingEmailSubmitBtn');
    const messageEl = document.getElementById('landingEmailMessage');
    submitBtn.disabled = true;
    submitBtn.textContent = 'Saving...';
    
    const email = document.getElementById('landingEmailInput').value;

    // Check honeypot
    if (document.getElementById('emailHoneypot').value !== '') {
        // Bot detected - pretend success
        messageEl.innerHTML = '<p style="background: #e8f5e9; color: #2d5016; padding: 12px 20px; border-radius: 8px; font-weight: 500; text-align: center;">Thanks, we\'ll keep you posted!</p>';
        submitBtn.disabled = false;
        submitBtn.textContent = 'Sign Up';
        this.reset();
        return;
    }

    try {
        await addDoc(collection(db, "emailSignups"), {
            email: email,
            signupDate: new Date().toISOString()
        });
        
        messageEl.innerHTML = '<p style="background: #e8f5e9; color: #2d5016; padding: 12px 20px; border-radius: 8px; font-weight: 500; text-align: center;">Thanks, we\'ll keep you posted!</p>';
        this.reset();
        
        setTimeout(() => {
            messageEl.innerHTML = '';
        }, 5000);
        
    } catch (error) {
        console.error("Error saving email:", error);
        messageEl.innerHTML = '<p style="background: #ffebee; color: #c62828; padding: 12px 20px; border-radius: 8px; font-weight: 500; text-align: center;">❌ Error: ' + error.message + '</p>';
    } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Sign Up';
    }
});
    </script>
<!-- Footer -->
<footer style="background: white; border-radius: 20px; padding: 40px; margin-bottom: 40px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06); max-width: 1200px; margin-left: auto; margin-right: auto;">

    
    <h3 style="font-size: 1.3em; font-weight: 600; color: #1a1a1a; margin-bottom: 15px; text-align: center;">Feedback?</h3>
    <p style="color: #666; font-size: 0.95em; line-height: 1.7; margin-bottom: 12px; text-align: center;">Contact us at: <a href="mailto:hello-trash@trashparty.org" style="color: #2d5016; font-weight: 600; text-decoration: none;">hello-trash@trashparty.org</a></p>
    
    <p style="margin-top: 20px; color: #666; font-size: 0.95em; line-height: 1.7;"><strong>Privacy Note:</strong> We collect only the information you provide (name, location, email) to track neighborhood cleanup efforts and send occasional updates. Your data is stored securely and never shared with third parties.</p>
    
    <div style="margin-top: 30px; padding-top: 30px; border-top: 2px solid #f0f0f0; font-size: 0.85em; color: #888;">
        <strong>Safety Disclaimer:</strong> Trash Party cleanups are not organized activities. By participating, you acknowledge that outdoor cleanup involves inherent risks (uneven ground, sharp objects, weather, etc.) and you take responsibility for your own safety. Please wear gloves, use caution, and skip anything that looks unsafe. When in doubt, don't pick it up.
    </div>
</footer>
</body>
</html>
